//Início de APP
var APP = APP || {};
APP._nameSpace = "APP";
APP.iniciar = function (Modulos) {
    var quantidadeDeModulos = arguments.length;
    if (Modulos !== undefined && Modulos !== APP) {
        APP.setUp();
    }
    if (quantidadeDeModulos == 0 || quantidadeDeModulos == 1) {
        this.iniciarModulos(Modulos || APP);
    } else if (quantidadeDeModulos > 1) {
        APP.iniciarModulos.apply(this, arguments);
    }
};
APP.setUp = function () {};
APP.iniciarModulos = function (Modulo) {
    var Filho, i = 0;
    if (arguments.length > 1) {
        for (; i < arguments.length; i++) {
            APP.iniciarModulos(arguments[i]);
        }
        return;
    }
    if (typeof Modulo != "object") return false;
    if (Modulo.hasOwnProperty('setUp') && typeof Modulo.setUp == "function") {
        Modulo.setUp();
    } else {
        return false;
    }
    for (Filho in Modulo) {
        if (Modulo.hasOwnProperty(Filho) === true) {
            if (Modulo[Filho] !== null && typeof Modulo[Filho] == "object") {
                Modulo[Filho]['pai'] = function () {
                    return Modulo;
                };
                Modulo[Filho]['_nameSpace'] = (Modulo['_nameSpace'] || "APP") + '.' + Filho;
                APP.iniciarModulos(Modulo[Filho]);
            }
        }
    }
    return false;
};
APP.nameSpace = function (nameSpace, arrayDeParametros) {
    var no, nos, escopos, alvo, i;
    if (arrayDeParametros !== undefined && arrayDeParametros instanceof Array === false) {
        arrayDeParametros = [arrayDeParametros];
    }
    escopos = [window];
    nos = nameSpace.split('.');
    for (i = 0; i < nos.length; i++) {
        no = nos[i];
        if (escopos[i].hasOwnProperty(no)) {
            escopos.push(escopos[i][no]);
        }
    }
    alvo = escopos.pop();
    if (typeof alvo == 'function') {
        return alvo.apply(escopos.pop(), arrayDeParametros || []);
    } else {
        return alvo;
    }
}
//FIM de APP
var APP = APP || {};

APP.Widget = {
  _tela: null,
  setUp: function() {
    var that = this,
        applicationCode = '<div class="google-translator-global-app" style="-webkit-transform: translate(0px,-200%)"> <section class="header-google-translator-app"> <div class="original-words-box-google-translator-app"> <h2 class="language-google-translator-app"></h2> <h2 class="words-google-translator-app"></h2> </div> <div class="translated-words-box-google-translator-app"> <h2 class="language-google-translator-app"></h2> <h2 class="words-google-translator-app"></h2> </div> <div class="close-google-translator-app">X</div></section></div>';

    document.querySelector('body').insertAdjacentHTML('beforeend', applicationCode);

    that.closeButtonF();

  },
  closeButtonF : function(argument) {
    var closeButton = document.querySelector('.close-google-translator-app');

     closeButton.addEventListener('click', function () {
        APP.Widget.exiteForApplication();
      }); 
  },
  openCloseDatailsBar : function(event) {
    var translationsContent = event.target.parentNode;

    if (translationsContent.classList.contains('off-bar-google-translator-app')) {
      translationsContent.classList.remove('off-bar-google-translator-app');
      translationsContent.classList.add('on-bar-google-translator-app');
    }else{
      translationsContent.classList.add('off-bar-google-translator-app');
      translationsContent.classList.remove('on-bar-google-translator-app');
    }
  },
  exiteForApplication : function() {
    var application = document.querySelector('.google-translator-global-app');
   
    application.classList.remove('translating-google-translator-app');
  },
  setLanguageName : function(language) {
    switch(language){
      case "af":
        language = "Afrikaans";
        break;
      case "sq":
        language = "Albanian";
        break;
      case "ar":
        language = "Arabic";
        break;
      case "az":
        language = "Azerbaijani";
        break;
      case "eu":
        language = "Basque";
        break;
      case "bn":
        language = "Bengali";
        break;
      case "be":
        language = "Belarusian";
        break;
      case "bg":
        language = "Bulgarian";
        break;
      case "ca":
        language = "Catalan";
        break;
      case "zh-CN":
        language = "Chinese Simplified";
        break;
      case "zh-TW":
        language = "Chinese Traditional";
        break;
      case "hr":
        language = "Croatian";
        break;
      case "cs":
        language = "Czech";
        break;
      case "da":
        language = "Danish";
        break;
      case "nl":
        language = "Dutch";
        break;
      case "en":
        language = "English";
        break;
      case "eo":
        language = "Esperanto";
        break;
      case "et":
        language = "Estonian";
        break;
      case "tl":
        language = "Filipino";
        break;
      case "fi":
        language = "Finnish";
        break;
      case "fr":
        language = "French";
        break;
      case "gl":
        language = "Galician";
        break;
      case "ka":
        language = "Georgian";
        break;
      case "de":
        language = "German";
        break;
      case "el":
        language = "Greek";
        break;
      case "gu":
        language = "Gujarati";
        break;
      case "ht":
        language = "Haitian Creole";
        break;
      case "iw":
        language = "Hebrew";
        break;
      case "hi":
        language = "Hindi";
        break;
      case "hu":
        language = "Hungarian";
        break;
      case "is":
        language = "Icelandic";
        break;
      case "id":
        language = "Indonesian";
        break;
      case "ga":
        language = "Irish";
        break;
      case "it":
        language = "Italian";
        break;
      case "js":
        language = "Japanese";
        break;      
      case "kn":
        language = "Kannada";
        break;
      case "ko":
        language = "Korean";
        break;
      case "la":
        language = "Latin";
        break;
      case "lv":
        language = "Latvian";
        break;
      case "lt":
        language = "Lithuanian";
        break;
      case "mk":
        language = "Macedonian";
        break;
      case "ms":
        language = "Malay";
        break;
      case "mt":
        language = "Maltese";
        break;
      case "no":
        language = "Norwegian";
        break;
      case "fa":
        language = "Persian";
        break;
      case "pl":
        language = "Polish";
        break;
      case "pt":
        language = "Portuguese";
        break;
      case "ro":
        language = "Romanian";
        break;
      case "ru":
        language = "Russian";
        break;
      case "sr":
        language = "Serbian";
        break;
      case "sk":
        language = "Slovak";
        break;
      case "sl":
        language = "Slovenian";
        break;
      case "es":
        language = "Spanish";
        break;
      case "sw":
        language = "Swahili";
        break;
      case "sv":
        language = "Swedish";
        break;
      case "ta":
        language = "Tamil";
        break;
      case "te":
        language = "Telugu";
        break;
      case "th":
        language = "Thai";
        break;
      case "tr":
        language = "Turkish";
        break;
      case "uk":
        language = "Ukrainian";
        break;
      case "ur":
        language = "Urdu";
        break;
      case "vi":
        language = "Vietnamese";
        break;
      case "cy":
        language = "Welsh";
        break;
      case "yi":
        language = "Yiddish";
        break;        
    }
    return language 
  },
  setAgradableLengthOnText : function() {
    var twoLines = 80,
        treeLines = twoLines + 40,
        fourLines = treeLines + 40,

    translatedText = document.querySelector('.translated-words-box-google-translator-app .words-google-translator-app');

    if(translatedText.offsetHeight >= fourLines){
      translatedText.classList.remove('fourLinesBest treeLinesBest twoLinesBest');
      translatedText.classList.add('fourLinesBest');
    }else if(translatedText.offsetHeight >= treeLines){
      translatedText.classList.remove('fourLinesBest treeLinesBest twoLinesBest');
      translatedText.classList.add('treeLinesBest');
    }else if(translatedText.offsetHeight >= twoLines){
      translatedText.classList.remove('fourLinesBest treeLinesBest twoLinesBest');
      translatedText.classList.add('twoLinesBest');
    }
  }
}
var APP = APP || {};
    APP.Widget = APP.Widget || {};

APP.Widget.GetSelection = {
  _tela: null,
  setUp: function() {
    var that = this,
    htmlDocument = document.querySelector('body');
    
    htmlDocument.addEventListener('keyup', function (event) {

      if (
          $(event.target).hasClass('google-translator-global-app translating-google-translator-app') ||
          $(event.target).hasClass('header-google-translator-app') ||
          $(event.target).hasClass('original-words-box-google-translator-app') ||
          $(event.target).hasClass('language-google-translator-app') ||
          $(event.target).hasClass('words-google-translator-app') ||
          $(event.target).hasClass('translated-words-box-google-translator-app') ||
          $(event.target).hasClass('language-google-translator-app') ||
          $(event.target).hasClass('words-google-translator-app') ||
          $(event.target).hasClass('close-google-translator-app')
      ){
        console.log('não vai!');
        return false;
      }else{
        that.doSomethingWithSelectedText();
      }
    });

    htmlDocument.addEventListener('mouseup', function (event) {

      if (
          $(event.target).hasClass('google-translator-global-app translating-google-translator-app') ||
          $(event.target).hasClass('header-google-translator-app') ||
          $(event.target).hasClass('original-words-box-google-translator-app') ||
          $(event.target).hasClass('language-google-translator-app') ||
          $(event.target).hasClass('words-google-translator-app') ||
          $(event.target).hasClass('translated-words-box-google-translator-app') ||
          $(event.target).hasClass('language-google-translator-app') ||
          $(event.target).hasClass('words-google-translator-app') ||
          $(event.target).hasClass('close-google-translator-app')
      ){
        console.log('não vai!');
        
        return false;
      }else{
        that.doSomethingWithSelectedText();
      }
    });
  },
  getSelectedText : function() {
    var text = "";
    if (typeof window.getSelection != "undefined") {
      text = window.getSelection().toString();
    } else if (typeof document.selection != "undefined" && document.selection.type == "Text") {
      text = document.selection.createRange().text;
    }
    return text.trim();
  },
  doSomethingWithSelectedText : function() {
    chrome.storage.sync.get('GoogleChromeWidgetState', function(obj) {
      if(obj.GoogleChromeWidgetState == 'On') {
        chrome.storage.sync.get('GoogleChromeWidgetDestinationLanguage', function(obj) { 
          var selectedText = APP.Widget.GetSelection.getSelectedText(),
              destinationLanguage = obj.GoogleChromeWidgetDestinationLanguage;
          
          if (
            selectedText
            && selectedText != " "
            && selectedText != undefined
            && selectedText != 'undefined'
            ){

            var originalText = document.querySelector('.original-words-box-google-translator-app .words-google-translator-app');
            var translatedLang = document.querySelector('.translated-words-box-google-translator-app .language-google-translator-app');

            originalText.innerText = selectedText;
            translatedLang.innerText = APP.Widget.setLanguageName(destinationLanguage);

            APP.Widget.Request.translateRequest(destinationLanguage, selectedText);
          }
        });
      }else{
        // alert('desligado')
      }
    });
  }
}
// 201438256023
var APP = APP || {};
    APP.Widget = APP.Widget || {};

APP.Widget.Request = {
  _tela: null,
  setUp: function() {
  },
  translateRequest : function(destinationLanguage, queryWords) {
    $.ajax({
      type: "GET",
      url: "https://www.googleapis.com/language/translate/v2",
      data: { key: "AIzaSyAWPJ8UimSTLnl9rBQKDRmx0_p_BCaPi04", target: destinationLanguage, q: queryWords },
      dataType: 'json',
      success: function (data) {
        APP.Widget.Request.successRequest(data.data.translations[0]);
      },
      error: function (data) {
        APP.Widget.Request.failRequest();
      }
    });
  },
  successRequest : function(data) {
    var application = document.querySelector('.google-translator-global-app'),
        translatedText = document.querySelector('.translated-words-box-google-translator-app .words-google-translator-app'),
        translatedLang = document.querySelector('.original-words-box-google-translator-app .language-google-translator-app');

    $('.translated-words-box-google-translator-app .words-google-translator-app').css('font-size', '36px !important');
    translatedLang.innerText = APP.Widget.setLanguageName(data.detectedSourceLanguage);
    translatedText.innerText = data.translatedText;
    
    APP.Widget.setAgradableLengthOnText();

    application.classList.add('translating-google-translator-app');
  },
  failRequest : function() {
    console.log("We were unable to translate this word :(");
  },
  afterRequest : function(data) {
    console.log("complete");
  }
}